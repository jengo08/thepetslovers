<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Perfil de Mascota ¬∑ The Pets Lovers</title>

  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Poppins:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

  <!-- TPL: INICIO BLOQUE NUEVO [Estilos locales del formulario de mascota] -->
  <style>
    :root{ --tpl-color:#339496; --tpl-text:#58425a; --tpl-border:#ececec; --tpl-muted:#666; --tpl-bg:#fff; }
    .tpl-page { padding-top: 110px; }
    .tpl-wrap { max-width: 920px; margin: 0 auto; padding: 16px; }
    .tpl-card { background: var(--tpl-bg); border:1px solid var(--tpl-border); border-radius: 14px; padding: 16px; box-shadow: 0 2px 10px rgba(0,0,0,.04); }
    .tpl-card h1 { margin:0 0 4px; }
    .tpl-card p.lead { color: var(--tpl-muted); margin:0 0 10px; }

    form.tpl-form { display:grid; gap:12px; }
    .tpl-row { display:grid; grid-template-columns:1fr; gap:10px; }
    @media(min-width:840px){ .tpl-row { grid-template-columns: 1fr 1fr; } }
    .tpl-field { display:flex; flex-direction:column; gap:6px; }
    .tpl-field label { font-weight:600; color:var(--tpl-text); }
    .tpl-input, .tpl-select, .tpl-textarea { border:1px solid var(--tpl-border); border-radius:10px; padding:10px 12px; font:inherit; color:#222; background:#fff; }
    .tpl-textarea { min-height: 96px; resize: vertical; }
    .tpl-actions { display:flex; gap:10px; flex-wrap:wrap; }
    .tpl-btn { display:inline-flex; align-items:center; gap:8px; justify-content:center; border-radius:10px; padding:10px 14px; border:1px solid var(--tpl-border); text-decoration:none; font-weight:600; color:#fff; background: var(--tpl-color); }
    .tpl-btn.secondary{ background:#fff; color:var(--tpl-text); }

    .tpl-section-title{ margin:2px 0 2px; font-weight:700; color:var(--tpl-text); }

    /* Avatar circular compacto */
    .tpl-avatar { position:relative; border:1px dashed var(--tpl-border); border-radius:14px; background:#fafafa; padding:12px; }
    .tpl-avatar-inner{ display:flex; align-items:center; gap:14px; }

    .tpl-avatar-thumb{ width:96px; height:96px; border-radius:50%; object-fit:cover; border:2px solid var(--tpl-border); background:#fff; }
    /* TPL: INICIO BLOQUE NUEVO [Solo huellita si no hay imagen: ocultar preview sin foto] */
    .tpl-avatar:not(.has-image) .tpl-avatar-thumb{ display:none; }
    /* TPL: FIN BLOQUE NUEVO */

    .tpl-avatar-icon{ position:absolute; left:12px; top:12px; width:96px; height:96px; display:flex; align-items:center; justify-content:center; color:#9aa0a6; font-size:40px; }
    .tpl-avatar.has-image .tpl-avatar-icon{ display:none; }

    .tpl-photo-controls{ display:flex; flex-direction:column; gap:8px; }
    .tpl-photo-actions{ display:none; gap:8px; flex-wrap:wrap; }
    .tpl-photo-actions .tpl-btn{ padding:8px 12px; }

    /* Modal cropper (drag/flechas) */
    .tpl-modal{ position:fixed; inset:0; background:rgba(0,0,0,.5); display:none; align-items:center; justify-content:center; z-index:9999; }
    .tpl-modal .box{ background:#fff; border-radius:14px; padding:14px; max-width:540px; width:calc(100% - 24px); }
    .tpl-modal h3{ margin:0 0 8px; color:var(--tpl-text); }
    .crop-area{ display:flex; flex-direction:column; gap:8px; align-items:center; }
    #cropCanvas{ width:320px; height:320px; background:#f3f3f3; border-radius:12px; border:1px solid #eee; touch-action:none; }
    .crop-hint{ font-size:.9rem; color:var(--tpl-muted); }
    .crop-actions{ display:flex; gap:8px; justify-content:flex-end; margin-top:8px; }

    /* Asegurar que .is-hidden realmente oculta (por si estilos globales) */
    /* TPL: INICIO BLOQUE NUEVO [is-hidden util] */
    .is-hidden{ display:none !important; }
    /* TPL: FIN BLOQUE NUEVO */

    /* Accesibilidad: label visualmente oculto para la foto */
    .sr-only{ position:absolute!important; width:1px; height:1px; clip:rect(1px,1px,1px,1px); overflow:hidden; white-space:nowrap; }
  </style>
  <!-- TPL: FIN BLOQUE NUEVO -->

  <!-- TPL: INICIO BLOQUE NUEVO [Modo seguro para evitar redirecciones del navbar] -->
  <script>window.__TPL_SAFE_MODE__ = true;</script>
  <!-- TPL: FIN BLOQUE NUEVO -->
</head>
<body>

  <!-- TPL: INICIO BLOQUE NUEVO [Navbar inyectable + fallback] -->
  <div id="tpl-navbar">
    <noscript>
      <nav class="navbar">
        <div class="logo"><a href="index.html"><img src="images/logo.png.png" alt="The Pets Lovers"></a></div>
        <a href="index.html" class="home-button">Inicio</a>
        <ul class="nav-links">
          <li><a href="como-funciona.html">C√≥mo funciona</a></li>
          <li><a href="servicios.html">Servicios</a></li>
          <li><a href="index.html#contactanos">Cont√°ctanos</a></li>
          <li><a href="index.html#hazte-cuidador">Convi√©rtete en cuidador</a></li>
        </ul>
        <a class="login-button" href="#iniciar-sesion">Iniciar sesi√≥n</a>
      </nav>
    </noscript>
  </div>
  <!-- TPL: FIN BLOQUE NUEVO -->

  <main class="container tpl-page">
    <div class="tpl-wrap">
      <div class="tpl-card">
        <h1>Nueva mascota</h1>
        <p class="lead">Completa los datos de tu mascota para agilizar tu reserva.</p>

        <form class="tpl-form" id="tpl-pet-form" action="#" novalidate>
          <!-- ========== Datos de tu mascota ========== -->
          <div class="tpl-section-title"><strong>üê∂ Datos de tu mascota</strong></div>

          <!-- Foto -->
          <div class="tpl-field">
            <label for="foto" class="sr-only">Foto de la mascota</label>
            <div class="tpl-avatar" id="avatarBox">
              <div class="tpl-avatar-inner">
                <img id="preview" class="tpl-avatar-thumb" src="images/pet-placeholder.png" alt="Foto de la mascota">
                <div class="tpl-avatar-icon" id="avatarIcon" aria-hidden="true"><i class="fa-solid fa-paw"></i></div>

                <div class="tpl-photo-controls">
                  <div id="photoPickRow">
                    <input class="tpl-input" type="file" id="foto" name="foto" accept="image/*">
                  </div>
                  <div id="photoActions" class="tpl-photo-actions" aria-live="polite">
                    <button type="button" class="tpl-btn secondary" id="btnChangePhoto"><i class="fa-solid fa-image"></i> Cambiar foto</button>
                    <button type="button" class="tpl-btn" id="btnAdjustPhoto"><i class="fa-solid fa-crop"></i> Ajustar</button>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Nombre + Microchip -->
          <div class="tpl-row">
            <div class="tpl-field">
              <label for="nombre">Nombre de tu mascota <span aria-hidden="true">*</span></label>
              <input class="tpl-input" type="text" id="nombre" name="nombre" required placeholder="Luna, Max...">
            </div>
            <div class="tpl-field">
              <label for="microchip">N√∫mero de microchip <span aria-hidden="true">*</span></label>
              <div style="display:flex; gap:10px; align-items:center;">
                <input class="tpl-input" type="text" id="microchip" name="microchip" placeholder="Ej. 9851230..." required>
                <label style="display:flex;gap:6px;align-items:center;white-space:nowrap;">
                  <input type="checkbox" id="microchip_no_tiene"> <span>No tiene</span>
                </label>
              </div>
            </div>
          </div>

          <!-- Especie y Raza -->
          <div class="tpl-row">
            <div class="tpl-field">
              <label for="especie">Especie <span aria-hidden="true">*</span></label>
              <select class="tpl-select" id="especie" name="especie" required>
                <option value="">Selecciona‚Ä¶</option>
                <option value="Perro">Perro</option>
                <option value="Gato">Gato</option>
                <option value="Ex√≥tico">Ex√≥tico</option>
                <option value="Otro">Otro</option>
              </select>
            </div>
            <div class="tpl-field">
              <label for="raza" id="label-raza">Raza <span aria-hidden="true">*</span></label>
              <input class="tpl-input" list="tpl-breed-list" id="raza" name="raza" required placeholder="Elige o escribe‚Ä¶">
              <datalist id="tpl-breed-list"></datalist>
            </div>
          </div>

          <!-- Edad / Peso / Esterilizado / Vacunas -->
          <div class="tpl-row">
            <div class="tpl-field">
              <label for="edad">Edad aproximada <span aria-hidden="true">*</span></label>
              <input class="tpl-input" type="text" id="edad" name="edad" required placeholder="3 a√±os, 6 meses‚Ä¶">
            </div>
            <div class="tpl-field">
              <label for="peso">Peso (kg) <span aria-hidden="true">*</span></label>
              <input class="tpl-input" type="number" id="peso" name="peso" step="0.1" min="0" required placeholder="Ej. 12.5">
            </div>
          </div>

          <div class="tpl-row">
            <div class="tpl-field">
              <label for="esterilizado">¬øEst√° esterilizado/a? <span aria-hidden="true">*</span></label>
              <select class="tpl-select" id="esterilizado" name="esterilizado" required>
                <option value="">Selecciona‚Ä¶</option>
                <option>S√≠</option><option>No</option>
              </select>
            </div>
            <div class="tpl-field">
              <label for="vacunas">¬øEst√° al d√≠a de vacunas y desparasitaci√≥n? <span aria-hidden="true">*</span></label>
              <select class="tpl-select" id="vacunas" name="vacunas" required>
                <option value="">Selecciona‚Ä¶</option>
                <option>S√≠</option><option>No</option>
              </select>
            </div>
          </div>

          <!-- Salud y rutinas -->
          <div class="tpl-field">
            <label for="salud">¬øTiene alguna patolog√≠a o tratamiento que debamos conocer? <span aria-hidden="true">*</span></label>
            <textarea id="salud" name="salud" class="tpl-textarea" required placeholder="Describir brevemente"></textarea>
          </div>

          <div class="tpl-row">
            <div class="tpl-field">
              <label for="tratamiento">V√≠a de administraci√≥n de tratamiento, dosis y horario</label>
              <textarea id="tratamiento" name="tratamiento" class="tpl-textarea" placeholder="Oral/inyectable, dosis, horas‚Ä¶"></textarea>
            </div>
            <div class="tpl-field">
              <label for="comidas">Horario de comidas y dosis</label>
              <textarea id="comidas" name="comidas" class="tpl-textarea" placeholder="Ma√±ana/tarde, gramos‚Ä¶"></textarea>
            </div>
          </div>

          <div class="tpl-row">
            <div class="tpl-field">
              <label for="salidas">¬øCu√°ntas veces sale a la calle?</label>
              <input class="tpl-input" type="number" id="salidas" name="salidas" min="0" step="1" placeholder="Ej. 3">
            </div>
            <div class="tpl-field">
              <label for="tamano">Tama√±o</label>
              <select class="tpl-select" id="tamano" name="tamano">
                <option value="">Selecciona‚Ä¶</option>
                <option>Mini</option><option>Peque√±o</option><option>Mediano</option><option>Grande</option><option>Gigante</option>
              </select>
            </div>
          </div>

          <div class="tpl-row">
            <div class="tpl-field">
              <label for="clinica">Cl√≠nica veterinaria habitual</label>
              <input class="tpl-input" type="text" id="clinica" name="clinica" placeholder="Nombre de la cl√≠nica">
            </div>
            <div class="tpl-field">
              <label for="hospitalPref">¬øQu√© hospital prefer√≠s en caso de urgencia?</label>
              <input class="tpl-input" type="text" id="hospitalPref" name="hospitalPref" placeholder="Nombre del hospital">
            </div>
          </div>

          <div class="tpl-field">
            <label for="comportamiento">¬øC√≥mo se comporta con otros animales y personas? <span aria-hidden="true">*</span></label>
            <textarea id="comportamiento" name="comportamiento" class="tpl-textarea" required placeholder="Sociable, nervioso, ladra a otros perros, etc."></textarea>
          </div>

          <!-- ========== Extras y seguimiento ========== -->
          <div class="tpl-section-title"><strong>üì∏ Extras y seguimiento</strong></div>

          <!-- C√°maras -->
          <div class="tpl-row">
            <div class="tpl-field">
              <label for="camaras">¬øTienes c√°maras en casa? <span style="font-weight:400;">(para servicio a domicilio)</span></label>
              <select class="tpl-select" id="camaras" name="camaras">
                <option value="">Selecciona‚Ä¶</option>
                <option>S√≠</option><option>No</option>
              </select>
            </div>
          </div>

          <!-- Fotos y v√≠deos (debajo de c√°maras) -->
          <div class="tpl-row">
            <div class="tpl-field">
              <label for="fotos">¬øTe gustar√≠a recibir fotos y v√≠deos durante el servicio?</label>
              <select class="tpl-select" id="fotos" name="fotos">
                <option value="">Selecciona‚Ä¶</option>
                <option>S√≠</option><option>No</option><option>Me da igual</option>
              </select>
            </div>
          </div>

          <!-- Seguros (lado a lado) -->
          <div class="tpl-row">
            <div class="tpl-field">
              <label for="seguroVet">¬øTienes contratado seguro veterinario para tu mascota?</label>
              <select class="tpl-select" id="seguroVet" name="seguroVet">
                <option value="">Selecciona‚Ä¶</option>
                <option>S√≠</option><option>No</option>
              </select>

              <!-- TPL: INICIO BLOQUE NUEVO [Detalles del seguro: visibles solo si ‚ÄúS√≠‚Äù] -->
              <div id="seguroVetData" class="tpl-field is-hidden" hidden style="margin-top:8px;">
                <label>Detalles del seguro veterinario</label>
                <div class="tpl-row">
                  <input class="tpl-input" type="text" id="seguroVetComp" placeholder="Compa√±√≠a">
                  <input class="tpl-input" type="text" id="seguroVetNum" placeholder="N¬∫ de p√≥liza">
                </div>
              </div>
              <!-- TPL: FIN BLOQUE NUEVO -->
            </div>

            <div class="tpl-field">
              <label for="seguroRC">¬øTienes seguro de responsabilidad civil para tu mascota?</label>
              <select class="tpl-select" id="seguroRC" name="seguroRC">
                <option value="">Selecciona‚Ä¶</option>
                <option>S√≠</option><option>No</option>
              </select>
            </div>
          </div>

          <div class="tpl-actions">
            <button class="tpl-btn" id="saveBtn" type="button"><i class="fa-solid fa-floppy-disk"></i> Guardar y volver al perfil</button>
            <a class="tpl-btn secondary" href="perfil.html"><i class="fa-solid fa-xmark"></i> Cancelar</a>
          </div>
        </form>
      </div>
    </div>
  </main>

  <!-- Modal de recorte -->
  <div class="tpl-modal" id="cropperModal" aria-hidden="true" role="dialog" aria-label="Ajustar foto" tabindex="-1">
    <div class="box">
      <h3><i class="fa-solid fa-crop"></i> Ajustar foto</h3>
      <div class="crop-area">
        <canvas id="cropCanvas" width="320" height="320"></canvas>
        <div class="crop-hint">Arrastra con el dedo/rat√≥n para centrar. Usa ‚Üê ‚Üë ‚Üí ‚Üì para ajustes finos.</div>
        <div class="crop-actions">
          <button type="button" class="tpl-btn secondary" id="btnCancelCrop">Cancelar</button>
          <button type="button" class="tpl-btn" id="btnApplyCrop">Aplicar</button>
        </div>
      </div>
    </div>
  </div>

  <script src="tpl-navbar.js" defer></script>
  <script src="tpl-footer.js" defer></script>
  <script src="tpl-mascota.js" defer></script>
</body>
</html>
